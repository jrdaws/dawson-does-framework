# CRITICAL: Configurator Data Flow Issues

**Priority**: P0
**Date**: 2025-12-24
**From**: Quality Agent
**Affects**: User trust, product value

---

## Executive Summary

Analysis of a completed configurator export revealed **significant gaps** between user inputs, AI preview, and downloaded files. Users are seeing a full e-commerce site in the preview but receiving a basic starter template.

---

## Issues Requiring Immediate Fix

### Issue 1: Inspiration Data Not Persisted

**Problem**: User enters inspiration URL and description, but these are NOT saved to `.dd/` directory.

**User Input**:
- URL: `lowes.com`
- Text: "a service that connects people with warehouses for storage and Christmas decorations"

**Expected**: `.dd/inspiration.md` with this content
**Actual**: No file created

**Fix Required**:
```tsx
// In export flow, add:
if (config.inspiration) {
  files.push({
    path: '.dd/inspiration.md',
    content: `# Project Inspiration

## Reference URL
${config.inspirationUrl || 'Not provided'}

## Description
${config.inspirationText || 'Not provided'}

---
*Generated by dawson-does-framework configurator*
`
  });
}
```

### Issue 2: Mission Statement Not Saved

**Problem**: Context Fields collects Vision, Mission, Success Criteria but only Vision and Goals are saved.

**Expected**: `.dd/mission.md`
**Actual**: File doesn't exist

**Fix Required**:
```tsx
if (config.mission) {
  files.push({
    path: '.dd/mission.md',
    content: `# Project Mission

${config.mission}

---
*Generated by dawson-does-framework configurator*
`
  });
}
```

### Issue 3: Preview vs Download Mismatch (CRITICAL)

**Problem**: AI Preview shows:
- Full e-commerce UI with product grid
- Navigation with Login/Sign Up
- 4 product cards with "Add to Cart"
- Hero section with user's inspiration text

**Actual Download Contains**:
- Basic "Next Steps" starter page
- No components
- No navigation
- No product UI

**This is a trust violation**. Users see one thing, receive another.

**Fix Options**:

**Option A - Honest Preview**:
Change preview to show what's actually delivered (the starter page), with a badge saying "Full template available via CLI"

**Option B - Deliver What's Previewed**:
Actually generate and include the components shown in the preview

**Option C - Clear Messaging**:
Add prominent warning: "This preview shows the FULL template. ZIP download contains starter files only."

### Issue 4: Context Fields Not Used

**Problem**: User enters Vision, Mission, Success Criteria but:
- Vision is NOT used in preview
- None are used in generated code
- They're just saved to files that aren't referenced

**Current State**:
```
.dd/vision.md    → "plant store online"
Preview Hero     → "storage and Christmas decorations" (from Inspiration, not Vision)
```

**Fix Required**:
1. Use Vision in preview if available
2. Use context in generated README
3. Use context in metadata/SEO

### Issue 5: Conflicting Context Not Flagged

**Problem**: User entered:
- Vision: "plant store"
- Inspiration: "Christmas decorations"

These are completely different businesses. No warning shown.

**Fix Required**:
Add AI validation step that checks for semantic consistency between Vision, Mission, and Inspiration.

---

## Files to Modify

| File | Changes Needed |
|------|----------------|
| `website/app/api/generate/route.ts` | Add inspiration.md, mission.md to export |
| `website/lib/zip-generator.ts` | Include all .dd files |
| `website/app/components/configurator/AIPreview.tsx` | Add "Preview Only" warning |
| `website/app/components/configurator/ContextFields.tsx` | Save mission statement |
| `website/app/components/configurator/ExportStep.tsx` | Add "Starter vs Full" explanation |

---

## Testing Checklist

After fixes:
- [ ] Inspiration URL saved to `.dd/inspiration.md`
- [ ] Inspiration text saved to `.dd/inspiration.md`
- [ ] Mission statement saved to `.dd/mission.md`
- [ ] AI Preview has clear "preview only" disclaimer
- [ ] Export step explains starter vs full template
- [ ] Context consistency validation works

---

*Quality Agent Analysis | P0 Issue | 2025-12-24*

