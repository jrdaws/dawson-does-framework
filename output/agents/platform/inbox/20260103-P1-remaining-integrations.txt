# Task: Create Remaining 8 Integration Templates (P1 - High Priority)

Priority: P1 (High - 62% of user config not delivered)
Agent: Platform Agent
Date: 2026-01-03

## Problem

Users can configure 13 integrations in the UI, but only 5 have templates:
- ✅ Stripe (payments)
- ✅ Resend (email)
- ✅ PostHog (analytics)
- ✅ OpenAI (ai)
- ✅ UploadThing (storage)

The following 8 integrations are recorded in manifests but generate NO code:
- ❌ Supabase Auth
- ❌ Algolia Search
- ❌ Sanity CMS
- ❌ Sentry Monitoring
- ❌ Cloudinary Images
- ❌ Inngest Background Jobs
- ❌ Novu Notifications
- ❌ PostHog Feature Flags

## Objective

Create integration templates for all 8 missing integrations following the existing pattern.

## Template Structure (Follow Existing Pattern)

Each integration needs:
```
packages/templates/integrations/{category}/{provider}/
├── files.json           # Manifest with file list + env vars
├── lib/{provider}.ts    # Client initialization
├── components/*.tsx     # UI components (if applicable)
├── hooks/*.ts           # React hooks (if applicable)
└── app/api/**/*.ts      # API routes (if applicable)
```

## Deliverables

### 1. Supabase Auth (`auth/supabase/`)
Files needed:
- `lib/supabase/client.ts` - Browser client
- `lib/supabase/server.ts` - Server client (using cookies)
- `lib/supabase/middleware.ts` - Session refresh logic
- `middleware.ts` - Root middleware
- `components/auth/LoginForm.tsx`
- `components/auth/SignupForm.tsx`
- `components/auth/UserMenu.tsx`
- `app/(auth)/login/page.tsx`
- `app/(auth)/signup/page.tsx`
- `app/auth/callback/route.ts`
- `hooks/useAuth.ts`

Env vars: `NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`

### 2. Algolia Search (`search/algolia/`)
Files needed:
- `lib/algolia.ts` - Client setup
- `lib/algolia-indexer.ts` - Server-side indexing
- `components/search/SearchBox.tsx`
- `components/search/SearchResults.tsx`
- `components/search/SearchModal.tsx`
- `hooks/useSearch.ts`

Env vars: `NEXT_PUBLIC_ALGOLIA_APP_ID`, `NEXT_PUBLIC_ALGOLIA_SEARCH_KEY`, `ALGOLIA_ADMIN_KEY`

### 3. Sanity CMS (`cms/sanity/`)
Files needed:
- `lib/sanity.ts` - Client setup
- `lib/sanity-queries.ts` - GROQ queries
- `sanity.config.ts` - Studio config
- `sanity/schemas/index.ts` - Base schemas
- `app/studio/[[...index]]/page.tsx` - Embedded studio

Env vars: `NEXT_PUBLIC_SANITY_PROJECT_ID`, `NEXT_PUBLIC_SANITY_DATASET`, `SANITY_API_TOKEN`

### 4. Sentry Monitoring (`monitoring/sentry/`)
Files needed:
- `sentry.client.config.ts`
- `sentry.server.config.ts`
- `sentry.edge.config.ts`
- `instrumentation.ts`
- `app/global-error.tsx`

Env vars: `SENTRY_DSN`, `SENTRY_ORG`, `SENTRY_PROJECT`

### 5. Cloudinary Images (`imageOpt/cloudinary/`)
Files needed:
- `lib/cloudinary.ts` - Client setup
- `lib/cloudinary-upload.ts` - Upload helpers
- `components/CloudinaryImage.tsx` - Optimized image component
- `components/CloudinaryUpload.tsx` - Upload widget

Env vars: `NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME`, `CLOUDINARY_API_KEY`, `CLOUDINARY_API_SECRET`

### 6. Inngest Background Jobs (`backgroundJobs/inngest/`)
Files needed:
- `lib/inngest.ts` - Client setup
- `lib/inngest-functions.ts` - Function definitions
- `app/api/inngest/route.ts` - Inngest handler

Env vars: `INNGEST_EVENT_KEY`, `INNGEST_SIGNING_KEY`

### 7. Novu Notifications (`notifications/novu/`)
Files needed:
- `lib/novu.ts` - Server client
- `lib/novu-client.ts` - Browser client
- `components/NotificationBell.tsx`
- `components/NotificationCenter.tsx`
- `app/api/notifications/route.ts`

Env vars: `NOVU_API_KEY`, `NEXT_PUBLIC_NOVU_APP_ID`

### 8. PostHog Feature Flags (`featureFlags/posthog-flags/`)
Files needed:
- `lib/feature-flags.ts` - Flag helpers
- `hooks/useFeatureFlag.ts`
- `components/FeatureFlagWrapper.tsx`

Env vars: `NEXT_PUBLIC_POSTHOG_KEY` (shared with analytics)

## Update Integration Loader

After creating templates, update:
- `website/lib/generator/integration-loader.ts` - Add manifests for all 8
- Test that generator includes new files

## Test Criteria

1. [ ] All 8 integration folders created with files.json manifests
2. [ ] Each integration has lib file with proper env var checks
3. [ ] integration-loader.ts updated to load all 8
4. [ ] Export with new integration includes correct files
5. [ ] Generated project builds with new integrations

## Reference

- Existing templates: `packages/templates/integrations/`
- Integration loader: `website/lib/generator/integration-loader.ts`
- Report: `output/agents/quality/workspace/export-analysis-testprojectnew03.md`

## Priority Order (by user demand)

1. Supabase Auth (most requested)
2. Sentry Monitoring (common in production)
3. Algolia Search (e-commerce essential)
4. Sanity CMS (content sites)
5. Cloudinary Images (media handling)
6. Inngest Jobs (async processing)
7. Novu Notifications (engagement)
8. PostHog Flags (experimentation)

## Estimated Effort

| Integration | Time |
|-------------|------|
| Supabase Auth | 2 hours |
| Sentry | 1 hour |
| Algolia | 1.5 hours |
| Sanity | 1.5 hours |
| Cloudinary | 1 hour |
| Inngest | 1 hour |
| Novu | 1 hour |
| PostHog Flags | 30 min |
| Loader updates | 30 min |
| Testing | 1 hour |
| **Total** | ~11 hours |

---

*Platform Agent - Execute this task to complete integration coverage*

