ADVANCED TASK: Create Priority SOPs (Bug Triage, Doc Sync, Deployment)
======================================================================

AGENT: Documentation Agent
PRIORITY: P1 - HIGH
DATE: 2025-12-23

OBJECTIVE:
----------
Create three complete, detailed Standard Operating Procedures (SOPs) that have 
the highest effort-to-impact ratio for the dawson-does-framework multi-agent 
system. These SOPs will be used by all 13 agents to ensure consistent, 
high-quality collaboration.


CONTEXT:
--------
Read the proposed SOPs document first:
```bash
cat docs/PROPOSED_SOPS.md
```

Review existing SOPs for format consistency:
```bash
cat prompts/agents/AGENT_POLICIES.md
cat docs/FILE_UPDATE_POLICY.md
cat output/media-pipeline/MEDIA_PIPELINE.md
```


DELIVERABLES:
-------------

Create THREE complete SOP documents:

1. `docs/sops/BUG_TRIAGE_SOP.md`
2. `docs/sops/DOCUMENTATION_SYNC_SOP.md`
3. `docs/sops/DEPLOYMENT_SOP.md`


SOP 1: BUG TRIAGE SOP
=====================

Create a comprehensive bug handling process including:

### 1.1 Severity Classification
| Level | Name | Definition | Response Time | Examples |
|-------|------|------------|---------------|----------|
| P0 | Critical | Production down, data loss | Immediate | Site offline, auth broken |
| P1 | High | Major feature broken | <6 hours | Can't export, API errors |
| P2 | Medium | Minor feature issue | <24 hours | UI glitch, slow response |
| P3 | Low | Cosmetic/enhancement | Next cycle | Typo, color tweak |

### 1.2 Bug Report Template
```markdown
## Bug Report

**Severity**: P[0-3]
**Reported By**: [Agent/User]
**Date**: YYYY-MM-DD

### Description
[What's happening]

### Steps to Reproduce
1. [Step 1]
2. [Step 2]

### Expected Behavior
[What should happen]

### Actual Behavior
[What actually happens]

### Environment
- Browser/OS: 
- Version:
- Relevant logs:

### Assigned To
[Agent role]
```

### 1.3 Agent Routing Matrix
| Bug Type | Primary Agent | Backup Agent |
|----------|---------------|--------------|
| UI/Visual | Website | Template |
| CLI commands | CLI | Platform |
| API errors | Platform | Website |
| Integration | Integration | Platform |
| Test failures | Testing | (varies) |
| Documentation | Documentation | - |
| Template issues | Template | Integration |

### 1.4 Bug Lifecycle
```
Reported → Triaged → Assigned → In Progress → Fixed → Verified → Closed
```

### 1.5 Escalation Path
- P0: Immediately notify all active agents
- P1: Notify assigned agent + Platform Agent
- P2/P3: Normal queue processing

### 1.6 Bug Tracking Location
```
output/shared/bugs/
├── active/           # Current bugs
│   ├── P0/
│   ├── P1/
│   ├── P2/
│   └── P3/
├── fixed/            # Fixed, awaiting verification
└── closed/           # Verified and closed
```


SOP 2: DOCUMENTATION SYNC SOP
=============================

Create a documentation maintenance process including:

### 2.1 Sync Triggers
| Event | Documents to Update | Responsible Agent |
|-------|---------------------|-------------------|
| New feature added | User guide, API docs, README | Documentation |
| API endpoint changed | API_CONTRACTS.md, examples | Documentation |
| Config changed | COMPLETE_SETUP_GUIDE.md | Any (notify DOC) |
| New agent created | Memory README, AGENT_POLICIES.md | Documentation |
| SOP changed | Role files, policies | Documentation |
| Breaking change | Migration guide, changelog | Documentation |
| Dependency updated | COMPLETE_SETUP_GUIDE.md | Any (notify DOC) |

### 2.2 Documentation Freshness Check
```bash
# Run weekly or before releases
./scripts/check-doc-freshness.sh
```

Checks:
- [ ] README.md matches current features
- [ ] COMPLETE_SETUP_GUIDE.md version current
- [ ] API examples work
- [ ] All commands documented
- [ ] No dead links

### 2.3 Documentation Update Checklist
Before closing any task, verify:
- [ ] Did I add a new feature? → Update user docs
- [ ] Did I change an API? → Update API_CONTRACTS.md
- [ ] Did I add a config? → Update setup guide
- [ ] Did I change behavior? → Update relevant docs
- [ ] Did I add dependencies? → Update requirements

### 2.4 Cross-Reference Requirements
Every documentation file must include:
- Last updated date
- Version number (for critical docs)
- Links to related documents
- Agent responsible for maintenance

### 2.5 Documentation Review Cycle
| Document Type | Review Frequency | Reviewer |
|---------------|------------------|----------|
| Setup guides | Every release | Documentation |
| API docs | When API changes | Platform + Documentation |
| User guides | Monthly | Documentation |
| SOPs | Quarterly | Auditor + Documentation |
| Memory files | Every session | Assigned agent |


SOP 3: DEPLOYMENT SOP
=====================

Create a complete deployment process including:

### 3.1 Pre-Deployment Checklist
```markdown
## Pre-Deployment Checklist

### Code Quality
- [ ] All tests passing: `npm test`
- [ ] No linting errors: `npm run lint`
- [ ] Type check passes: `npm run type-check`
- [ ] No console.log statements in production code
- [ ] No hardcoded secrets or API keys

### Testing
- [ ] Unit tests coverage >80%
- [ ] Integration tests pass
- [ ] E2E tests pass
- [ ] Manual smoke test completed
- [ ] Mobile responsive verified

### Documentation
- [ ] CHANGELOG.md updated
- [ ] README.md current
- [ ] API docs match implementation
- [ ] Breaking changes documented

### Infrastructure
- [ ] Environment variables set in production
- [ ] Database migrations ready
- [ ] CDN/cache invalidation planned
- [ ] Rollback procedure documented
```

### 3.2 Deployment Workflow
```
1. Testing Agent: Confirm all tests pass
      ↓
2. Documentation Agent: Verify docs updated
      ↓
3. Platform Agent: Prepare deployment
   - Build production bundle
   - Verify environment config
   - Prepare database migrations
      ↓
4. Deploy to Staging
   - Run migrations
   - Deploy code
   - Verify health check
      ↓
5. Staging Verification (15 min)
   - Smoke tests
   - Critical path testing
   - Performance check
      ↓
6. Deploy to Production
   - Run migrations
   - Deploy code
   - Verify health check
      ↓
7. Post-Deploy Verification
   - Health check passing
   - Key features working
   - Monitoring alerts clear
      ↓
8. Announcement
   - Update status page
   - Notify stakeholders
```

### 3.3 Rollback Procedure
```bash
# If issues detected within 30 minutes:
1. Revert to previous deployment
2. Run health check
3. Investigate in staging
4. Create bug report (P1 minimum)
5. Schedule re-deployment
```

### 3.4 Deployment Schedule
| Type | When | Approval Needed |
|------|------|-----------------|
| Hotfix (P0) | Immediately | No (but notify) |
| Patch (P1-P2) | Within 24h | Platform Agent |
| Minor | Weekly | Testing + Platform |
| Major | Bi-weekly | All stakeholders |

### 3.5 Environment Configuration
```
Production:  vercel/production branch
Staging:     vercel/preview on PR
Development: localhost:3000
```

### 3.6 Deployment Commands
```bash
# Build and verify locally
npm run build
npm run start  # Test production build

# Deploy to staging (automatic on PR)
git push origin feature-branch

# Deploy to production
git push origin main  # Triggers Vercel deploy

# Verify deployment
curl https://dawson-does.vercel.app/api/health
```


IMPLEMENTATION REQUIREMENTS:
----------------------------

1. Create folder structure:
```bash
mkdir -p docs/sops
mkdir -p output/shared/bugs/{active/{P0,P1,P2,P3},fixed,closed}
mkdir -p scripts
```

2. Create the three SOP files with COMPLETE content (not placeholders)

3. Create helper script `scripts/check-doc-freshness.sh`

4. Update AGENT_POLICIES.md to reference new SOPs

5. Update COMPLETE_SETUP_GUIDE.md to mention SOPs

6. Add SOPs to .protected-files


FORMAT REQUIREMENTS:
--------------------

Each SOP must include:
- Version and date header
- Table of contents for long documents
- Clear step-by-step workflows
- Checklists where appropriate
- Agent responsibility assignments
- Examples and templates
- Related document links


SUCCESS CRITERIA:
-----------------

□ All 3 SOP files created with complete content
□ Folder structures created
□ Helper script created
□ Agent routing is clear and unambiguous
□ Checklists are actionable
□ Workflows have clear start/end points
□ SOPs reference each other appropriately
□ AGENT_POLICIES.md updated with SOP references
□ Protected files list updated


HANDOFF:
--------

When complete:
1. Move this file to `output/documentation-agent/done/`
2. Create completion report in `output/documentation-agent/outbox/`
3. Output Testing Agent prompt to verify SOPs work

```
## Next Agent: Testing Agent

Copy this to activate:

Read docs/sops/BUG_TRIAGE_SOP.md, docs/sops/DOCUMENTATION_SYNC_SOP.md, and 
docs/sops/DEPLOYMENT_SOP.md. Create a test bug report and walk through each 
SOP to verify the workflows are complete and actionable.
```

