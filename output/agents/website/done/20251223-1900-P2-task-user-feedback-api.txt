# Task: User Feedback Collection Endpoint

**Priority:** P2 (Medium)
**Assigned To:** Website Agent
**Created:** 2025-12-23 19:00
**Quality Score:** 7.8/10

---

## ⚠️ Dependency Note

This task depends on **production deployment** being complete. If deployment hasn't happened yet, you can still implement the endpoint locally, but production testing must wait.

---

## Context

With Phase 1 complete and production deployment in preparation, we need to collect structured user feedback to guide Phase 2 development. This is essential for:
- Validating generation quality
- Understanding UX issues
- Prioritizing improvements

## Vision Alignment

- **Export-First**: Feedback helps improve exported project quality
- **Developer-Centric**: Built for developers to provide structured feedback
- **Transparency**: Users know their feedback is valued

## Objectives

1. Create POST /api/feedback endpoint
2. Store feedback in Supabase (simple schema)
3. Include generation context (project config, tier used)
4. Implement basic rate limiting (prevent spam)

## Success Criteria

- [ ] Feedback endpoint exists and works (POST /api/feedback)
- [ ] Feedback stored in Supabase with timestamps
- [ ] Rate limited (5 submissions per IP per hour)
- [ ] Validation on input (rating 1-5, message <= 1000 chars)
- [ ] Tests added for the endpoint

## Files to Create

```
website/app/api/feedback/route.ts        # POST endpoint
website/lib/supabase/feedback.ts         # Supabase operations
website/components/configurator/FeedbackForm.tsx  # Optional UI component
```

## Schema Suggestion

```sql
CREATE TABLE feedback (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  rating INT CHECK (rating >= 1 AND rating <= 5),
  message TEXT,
  project_config JSONB,          -- What was being generated
  generation_tier VARCHAR(20),   -- fast/balanced/quality
  ip_hash VARCHAR(64),           -- For rate limiting (hashed)
  created_at TIMESTAMPTZ DEFAULT NOW()
);
```

## API Contract

Following `docs/standards/API_CONTRACTS.md`:

```typescript
// POST /api/feedback
// Request
{
  rating: 1-5,
  message?: string,
  projectConfig?: { template, features, integrations },
  generationTier?: 'fast' | 'balanced' | 'quality'
}

// Success Response (201)
{ success: true, data: { id: 'uuid' } }

// Error Response (429 for rate limit)
{ success: false, error: { code: 'RATE_LIMIT_EXCEEDED', message: '...', recovery: '...' } }
```

## Handoff

1. Move task to `output/website-agent/done/`
2. Write completion report with SQL migration
3. Update `prompts/agents/memory/WEBSITE_MEMORY.md`
4. Provide SQL for Supabase migration

---

*Curated by CURATOR Agent | Cycle 5*

